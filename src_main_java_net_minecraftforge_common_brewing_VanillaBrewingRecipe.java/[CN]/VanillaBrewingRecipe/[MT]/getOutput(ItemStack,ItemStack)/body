{
  if (ingredient != null && input != null && input.getItem() instanceof ItemPotion) {
    int inputMeta=input.getMetadata();
    int outputMeta=PotionHelper.applyIngredient(inputMeta,ingredient.getItem().getPotionEffect(ingredient));
    if (inputMeta == outputMeta) {
      return null;
    }
    List oldEffects=Items.potionitem.getEffects(inputMeta);
    List newEffects=Items.potionitem.getEffects(outputMeta);
    boolean hasResult=false;
    if ((inputMeta <= 0 || oldEffects != newEffects) && (oldEffects == null || !oldEffects.equals(newEffects) && newEffects != null)) {
      hasResult=true;
    }
 else     if (!ItemPotion.isSplash(inputMeta) && ItemPotion.isSplash(outputMeta)) {
      hasResult=true;
    }
    if (hasResult) {
      ItemStack output=input.copy();
      output.setItemDamage(outputMeta);
      return output;
    }
  }
  return null;
}
