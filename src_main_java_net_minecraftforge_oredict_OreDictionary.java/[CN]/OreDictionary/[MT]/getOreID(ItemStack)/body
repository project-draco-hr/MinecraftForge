{
  if (stack == null || stack.getItem() == null)   return -1;
  int id=Item.getIdFromItem(stack.getItem());
  List<Integer> ids=stackToId.get(id);
  if (ids == null || ids.size() == 0) {
    ids=stackToId.get(id | ((stack.getItemDamage() + 1) << 16));
  }
  return (ids != null && ids.size() > 0) ? ids.get(0) : -1;
}
