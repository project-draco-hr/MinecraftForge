{
  try {
    ModClassLoader modClassLoader=event.getModClassLoader();
    modClassLoader.addFile(source);
    Class<?> clazz=Class.forName(className,true,modClassLoader);
    Certificate[] certificates=clazz.getProtectionDomain().getCodeSource().getCertificates();
    int len=0;
    if (certificates != null) {
      len=certificates.length;
    }
    Builder<String> certBuilder=ImmutableList.<String>builder();
    for (int i=0; i < len; i++) {
      certBuilder.add(CertificateHelper.getFingerprint(certificates[i]));
    }
    ImmutableList<String> certList=certBuilder.build();
    sourceFingerprints=ImmutableSet.copyOf(certList);
    String expectedFingerprint=(String)descriptor.get("certificateFingerprint");
    fingerprintNotPresent=true;
    if (expectedFingerprint != null && !expectedFingerprint.isEmpty()) {
      if (!sourceFingerprints.contains(expectedFingerprint)) {
        Level warnLevel=Level.SEVERE;
        if (source.isDirectory()) {
          warnLevel=Level.FINER;
        }
        FMLLog.log(getModId(),warnLevel,"The mod %s is expecting signature %s for source %s, however there is no signature matching that description",getModId(),expectedFingerprint,source.getName());
      }
 else {
        certificate=certificates[certList.indexOf(expectedFingerprint)];
        fingerprintNotPresent=false;
      }
    }
    CustomProperty[] props=(CustomProperty[])descriptor.get("customProperties");
    if (props != null && props.length > 0) {
      com.google.common.collect.ImmutableMap.Builder<String,String> builder=ImmutableMap.<String,String>builder();
      for (      CustomProperty p : props) {
        builder.put(p.k(),p.v());
      }
      customModProperties=builder.build();
    }
 else {
      customModProperties=EMPTY_PROPERTIES;
    }
    Method factoryMethod=gatherAnnotations(clazz);
    isNetworkMod=FMLNetworkHandler.instance().registerNetworkMod(this,clazz,event.getASMHarvestedData());
    modInstance=getLanguageAdapter().getNewInstance(this,clazz,modClassLoader,factoryMethod);
    if (fingerprintNotPresent) {
      eventBus.post(new FMLFingerprintViolationEvent(source.isDirectory(),source,ImmutableSet.copyOf(this.sourceFingerprints),expectedFingerprint));
    }
    ProxyInjector.inject(this,event.getASMHarvestedData(),FMLCommonHandler.instance().getSide(),getLanguageAdapter());
    processFieldAnnotations(event.getASMHarvestedData());
  }
 catch (  Throwable e) {
    controller.errorOccurred(this,e);
    Throwables.propagateIfPossible(e);
  }
}
