{
  this.netHandler=inethandler;
  EmbeddedChannel internalChannel=NetworkRegistry.INSTANCE.getChannel(this.channel,this.target);
  if (internalChannel != null) {
    internalChannel.attr(NetworkRegistry.NET_HANDLER).set(this.netHandler);
    try {
      if (internalChannel.writeInbound(this)) {
        FMLLog.severe("A packet for channel %s for side %s was not processed by the embedded channel - it has been dropped. Payload\n%s",this.channel,this.target,ByteBufUtils.getContentDump(this.payload));
      }
      internalChannel.inboundMessages().clear();
    }
 catch (    FMLNetworkException ne) {
      FMLLog.log(Level.ERROR,ne,"There was a network exception handling a packet on channel %s",channel);
      dispatcher.rejectHandshake(ne.getMessage());
    }
catch (    Throwable t) {
      FMLLog.log(Level.ERROR,t,"There was a critical exception handling a packet on channel %s",channel);
      dispatcher.rejectHandshake("A fatal error has occured, this connection is terminated");
    }
  }
}
