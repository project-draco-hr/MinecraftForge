{
  FluidStack fluidStack=getFluid(itemstack);
  if (fluidStack == null) {
    return itemstack;
  }
  MovingObjectPosition mop=this.getMovingObjectPositionFromPlayer(world,player,false);
  if (mop != null && mop.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK) {
    BlockPos clickPos=mop.getBlockPos();
    if (world.isBlockModifiable(player,clickPos)) {
      BlockPos targetPos=clickPos.offset(mop.sideHit);
      if (player.canPlayerEdit(targetPos,mop.sideHit,itemstack)) {
        if (this.tryPlaceFluid(fluidStack.getFluid().getBlock(),world,targetPos) && !player.capabilities.isCreativeMode) {
          player.triggerAchievement(StatList.objectUseStats[Item.getIdFromItem(this)]);
          itemstack.stackSize--;
          ItemStack emptyStack=empty != null ? empty.copy() : new ItemStack(this);
          if (itemstack.stackSize <= 0) {
            return emptyStack;
          }
 else {
            ItemHandlerHelper.giveItemToPlayer(player,emptyStack);
            return itemstack;
          }
        }
      }
    }
  }
  return itemstack;
}
