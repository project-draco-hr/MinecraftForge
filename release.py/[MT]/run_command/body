def run_command(command, cwd='.', verbose=True):
    print 'Running command: '
    print pformat(command)
    process = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, bufsize=1, cwd=cwd)
    while (process.poll() is None):
        line = process.stdout.readline()
        if line:
            line = line.rstrip()
            print line
    if process.returncode:
        print 'failed: {0}'.format(process.returncode)
        return False
    return True
