def get_branch_name():
    from subprocess import Popen, PIPE, STDOUT
    branch = ''
    if (os.getenv('GIT_BRANCH') is None):
        try:
            process = Popen(['git', 'rev-parse', '--abbrev-ref', 'HEAD'], stdout=PIPE, stderr=STDOUT, bufsize=(-1))
            (branch, _) = process.communicate()
            branch = branch.rstrip('\r\n')
        except OSError:
            print 'Git not found'
    else:
        branch = os.getenv('GIT_BRANCH').rpartition('/')[2]
    branch = branch.replace('master', '')
    print ("Detected Branch as '%s'" % branch)
    return branch
