{
  FMLLog.fine("Attempting to inject @SidedProxy classes into %s",mod.getModId());
  Set<ASMData> targets=data.getAnnotationsFor(mod).get(SidedProxy.class.getName());
  ClassLoader mcl=Loader.instance().getModClassLoader();
  for (  ASMData targ : targets) {
    try {
      String modid=(String)targ.getAnnotationInfo().get("modId");
      if (modid == null) {
        for (        ASMData a : data.getAll(Mod.class.getName())) {
          if (isProxyFromMod(a.getClassName(),targ.getClassName())) {
            modid=(String)a.getAnnotationInfo().get("modid");
            break;
          }
        }
      }
      if (modid == null) {
        FMLLog.warning("Unable to determine the associated mod for proxy injection for %s.%s, assuming it's from %s",targ.getClassName(),targ.getObjectName(),mod.getModId());
      }
 else       if (!modid.equals(mod.getModId())) {
        FMLLog.fine("Skipping proxy injection for %s.%s since it is not for mod %s, it should belong to %s",targ.getClassName(),targ.getObjectName(),mod.getModId(),modid);
        continue;
      }
      Class<?> proxyTarget=Class.forName(targ.getClassName(),true,mcl);
      Field target=proxyTarget.getDeclaredField(targ.getObjectName());
      if (target == null) {
        FMLLog.severe("Attempted to load a proxy type into %s.%s but the field was not found",targ.getClassName(),targ.getObjectName());
        throw new LoaderException(String.format("Attempted to load a proxy type into %s.%s but the field was not found",targ.getClassName(),targ.getObjectName()));
      }
      target.setAccessible(true);
      SidedProxy annotation=target.getAnnotation(SidedProxy.class);
      String targetType=side.isClient() ? annotation.clientSide() : annotation.serverSide();
      if (targetType.equals("")) {
        targetType=targ.getClassName() + (side.isClient() ? "$ClientProxy" : "$ServerProxy");
      }
      Object proxy=Class.forName(targetType,true,mcl).newInstance();
      if (languageAdapter.supportsStatics() && (target.getModifiers() & Modifier.STATIC) == 0) {
        FMLLog.severe("Attempted to load a proxy type %s into %s.%s, but the field is not static",targetType,targ.getClassName(),targ.getObjectName());
        throw new LoaderException(String.format("Attempted to load a proxy type %s into %s.%s, but the field is not static",targetType,targ.getClassName(),targ.getObjectName()));
      }
      if (!target.getType().isAssignableFrom(proxy.getClass())) {
        FMLLog.severe("Attempted to load a proxy type %s into %s.%s, but the types don't match",targetType,targ.getClassName(),targ.getObjectName());
        throw new LoaderException(String.format("Attempted to load a proxy type %s into %s.%s, but the types don't match",targetType,targ.getClassName(),targ.getObjectName()));
      }
      languageAdapter.setProxy(target,proxyTarget,proxy);
    }
 catch (    Exception e) {
      FMLLog.log(Level.ERROR,e,"An error occurred trying to load a proxy into %s.%s",targ.getAnnotationInfo(),targ.getClassName(),targ.getObjectName());
      throw new LoaderException(e);
    }
  }
  languageAdapter.setInternalProxies(mod,side,mcl);
}
