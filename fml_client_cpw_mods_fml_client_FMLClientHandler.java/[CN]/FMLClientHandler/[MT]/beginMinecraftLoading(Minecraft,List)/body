{
  client=minecraft;
  this.resourcePackList=resourcePackList;
  if (minecraft.func_71355_q()) {
    FMLLog.severe("DEMO MODE DETECTED, FML will not work. Finishing now.");
    haltGame("FML will not run in demo mode",new RuntimeException());
    return;
  }
  loading=true;
  FMLCommonHandler.instance().beginLoading(this);
  new ModLoaderClientHelper(client);
  try {
    Class<?> optifineConfig=Class.forName("Config",false,Loader.instance().getModClassLoader());
    String optifineVersion=(String)optifineConfig.getField("VERSION").get(null);
    Map<String,Object> dummyOptifineMeta=ImmutableMap.<String,Object>builder().put("name","Optifine").put("version",optifineVersion).build();
    ModMetadata optifineMetadata=MetadataCollection.from(getClass().getResourceAsStream("optifinemod.info"),"optifine").getMetadataForId("optifine",dummyOptifineMeta);
    optifineContainer=new DummyModContainer(optifineMetadata);
    FMLLog.info("Forge Mod Loader has detected optifine %s, enabling compatibility features",optifineContainer.getVersion());
  }
 catch (  Exception e) {
    optifineContainer=null;
  }
  try {
    Loader.instance().loadMods();
    client.func_110436_a();
  }
 catch (  WrongMinecraftVersionException wrong) {
    wrongMC=wrong;
  }
catch (  DuplicateModsFoundException dupes) {
    dupesFound=dupes;
  }
catch (  MissingModsException missing) {
    modsMissing=missing;
  }
catch (  ModSortingException sorting) {
    modSorting=sorting;
  }
catch (  CustomModLoadingErrorDisplayException custom) {
    FMLLog.log(Level.SEVERE,custom,"A custom exception was thrown by a mod, the game will now halt");
    customError=custom;
  }
catch (  LoaderException le) {
    haltGame("There was a severe problem during mod loading that has caused the game to fail",le);
    return;
  }
}
