def zip_folder(path, key, zip):
    import pprint
    files = os.listdir(path)
    for file in files:
        file_path = os.path.join(path, file)
        file_key = os.path.join(key, file)
        if os.path.isdir(file_path):
            zip_folder(file_path, file_key, zip)
        elif (not (file_key.replace(os.sep, '/') in zip.NameToInfo)):
            print ('    ' + file_key)
            zip.write(file_path, file_key)
