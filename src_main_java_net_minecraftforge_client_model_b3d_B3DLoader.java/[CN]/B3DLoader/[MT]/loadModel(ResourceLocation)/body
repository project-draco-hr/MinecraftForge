{
  ResourceLocation file=new ResourceLocation(modelLocation.getResourceDomain(),modelLocation.getResourcePath());
  if (!cache.containsKey(file)) {
    try {
      IResource resource=null;
      try {
        resource=manager.getResource(file);
      }
 catch (      FileNotFoundException e) {
        if (modelLocation.getResourcePath().startsWith("models/block/"))         resource=manager.getResource(new ResourceLocation(file.getResourceDomain(),"models/item/" + file.getResourcePath().substring("models/block/".length())));
 else         if (modelLocation.getResourcePath().startsWith("models/item/"))         resource=manager.getResource(new ResourceLocation(file.getResourceDomain(),"models/block/" + file.getResourcePath().substring("models/item/".length())));
 else         throw e;
      }
      B3DModel.Parser parser=new B3DModel.Parser(resource.getInputStream());
      B3DModel model=parser.parse();
      cache.put(file,model);
    }
 catch (    IOException e) {
      cache.put(file,null);
      throw e;
    }
  }
  B3DModel model=cache.get(file);
  if (model == null)   return ModelLoaderRegistry.getMissingModel();
  if (modelLocation instanceof B3DMeshLocation) {
    String mesh=((B3DMeshLocation)modelLocation).getMesh();
    if (!model.getMeshes().containsKey(mesh)) {
      FMLLog.severe("No mesh named %s in model %s, skipping",mesh,modelLocation);
      return ModelLoaderRegistry.getMissingModel();
    }
    return new ModelWrapper(modelLocation,model,ImmutableSet.of(mesh),1);
  }
  if (!(model.getRoot().getKind() instanceof Mesh)) {
    return new ModelWrapper(modelLocation,model,ImmutableSet.<String>of(),1);
  }
  return new ModelWrapper(modelLocation,model,ImmutableSet.of(((Node<Mesh>)model.getRoot()).getName()),1);
}
