{
  boolean handled=false;
  if (msg instanceof C17PacketCustomPayload) {
    handled=handleServerSideCustomPacket((C17PacketCustomPayload)msg,ctx);
  }
 else   if (msg instanceof S3FPacketCustomPayload) {
    handled=handleClientSideCustomPacket((S3FPacketCustomPayload)msg,ctx);
  }
 else   if (state != ConnectionState.CONNECTED && state != ConnectionState.HANDSHAKECOMPLETE) {
    handled=handleVanilla(msg);
  }
  if (!handled) {
    ctx.fireChannelRead(msg);
  }
}
