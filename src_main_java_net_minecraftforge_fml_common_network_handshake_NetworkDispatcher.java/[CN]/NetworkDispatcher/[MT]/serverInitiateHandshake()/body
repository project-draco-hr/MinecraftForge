{
  this.state=ConnectionState.AWAITING_HANDSHAKE;
  serverHandler=new NetHandlerPlayServer(scm.getServerInstance(),manager,player){
    @Override public void update(){
      if (NetworkDispatcher.this.state == ConnectionState.FINALIZING) {
        completeServerSideConnection(ConnectionType.MODDED);
      }
      super.update();
    }
  }
;
  this.netHandler=serverHandler;
  player.playerNetServerHandler=null;
  this.manager.setConnectionState(EnumConnectionState.PLAY);
  NBTTagCompound playerNBT=scm.getPlayerNBT(player);
  if (playerNBT != null) {
    return playerNBT.getInteger("Dimension");
  }
 else {
    return 0;
  }
}
