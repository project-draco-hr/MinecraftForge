{
  if (basicClass == null)   return null;
  ClassNode classNode=new ClassNode();
  ClassReader classReader=new ClassReader(basicClass);
  classReader.accept(classNode,0);
  for (  MethodNode m : classNode.methods) {
    for (ListIterator<AbstractInsnNode> it=m.instructions.iterator(); it.hasNext(); ) {
      AbstractInsnNode insnNode=it.next();
      if (insnNode.getType() == AbstractInsnNode.FIELD_INSN) {
        FieldInsnNode fi=(FieldInsnNode)insnNode;
        if (FLUID_TYPE.equals(fi.owner) && LEGACY_FIELDNAME.equals(fi.name) && fi.getOpcode() == Opcodes.GETFIELD) {
          FMLLog.fine("Method %s.%s%s: Replacing GETFIELD fluidID with INVOKEVIRTUAL getFluidID",name,m.name,m.desc);
          it.remove();
          MethodInsnNode replace=new MethodInsnNode(Opcodes.INVOKEVIRTUAL,FLUID_TYPE,GETID_NAME,GETID_DESC,false);
          it.add(replace);
        }
      }
    }
  }
  ClassWriter writer=new ClassWriter(ClassWriter.COMPUTE_MAXS);
  classNode.accept(writer);
  return writer.toByteArray();
}
