{
  try {
    URL libDownload=new URL(String.format(rootUrl,realFilePath));
    System.out.println("Downloading file: " + libDownload.getHost() + libDownload.getPath());
    System.out.println("The libFile's path is " + libFile.getAbsolutePath());
    String infoString=String.format("Downloading file %s",libDownload.toString());
    downloadMonitor.updateProgressString(infoString);
    FMLRelaunchLog.info(infoString);
    URLConnection connection=libDownload.openConnection();
    connection.setConnectTimeout(5000);
    connection.setReadTimeout(5000);
    connection.setRequestProperty("User-Agent","FML Relaunch Downloader");
    int sizeGuess=connection.getContentLength();
    performDownload(connection.getInputStream(),sizeGuess,hash,libFile);
    downloadMonitor.updateProgressString("Download complete");
    FMLRelaunchLog.info("Download complete");
  }
 catch (  Exception e) {
    if (downloadMonitor.shouldStopIt()) {
      FMLRelaunchLog.warning("You have stopped the downloading operation before it could complete");
      return;
    }
    if (e instanceof RuntimeException)     throw (RuntimeException)e;
    FMLRelaunchLog.severe("There was a problem downloading the file %s automatically. Perhaps you " + "have an environment without internet access. You will need to download " + "the file manually or restart and let it try again\n",libFile.getName());
    libFile.delete();
    throw new RuntimeException("A download error occured",e);
  }
}
