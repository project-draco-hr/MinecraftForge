def zip_add_perm(file, perm, key=None):
    if (key == None):
        key = os.path.basename(file)
    else:
        key = key.replace('/', os.sep)
    if (not (zip_base is None)):
        key = os.path.join(zip_base, key)
    file = os.path.join(forge_dir, file.replace('/', os.sep))
    if os.path.isfile(file):
        print key
        with open(file, 'r') as fh:
            data = fh.read()
        info = zipfile.ZipInfo(name)
        info.external_attr = (perm << 16L)
        zip.writestr(info, data)
