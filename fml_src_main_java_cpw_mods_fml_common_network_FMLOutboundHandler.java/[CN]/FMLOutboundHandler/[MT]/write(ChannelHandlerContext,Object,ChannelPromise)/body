{
  if (!(msg instanceof FMLProxyPacket)) {
    return;
  }
  OutboundTarget outboundTarget;
  Object args=null;
  if (ctx.channel().attr(NetworkRegistry.CHANNEL_SOURCE).get() == Side.CLIENT) {
    outboundTarget=OutboundTarget.TOSERVER;
  }
 else {
    outboundTarget=ctx.channel().attr(FML_MESSAGETARGET).get();
    args=ctx.channel().attr(FML_MESSAGETARGETARGS).get();
    outboundTarget.validateArgs(args);
  }
  List<NetworkDispatcher> dispatchers=outboundTarget.selectNetworks(args);
  if (dispatchers == null) {
    ctx.write(msg,promise);
    return;
  }
  for (  NetworkDispatcher dispatcher : dispatchers) {
    dispatcher.sendProxy((FMLProxyPacket)msg);
  }
}
