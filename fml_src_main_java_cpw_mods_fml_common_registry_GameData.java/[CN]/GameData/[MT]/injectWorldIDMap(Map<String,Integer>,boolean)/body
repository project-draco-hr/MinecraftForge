{
  Map<String,Integer[]> remaps=Maps.newHashMap();
  ArrayListMultimap<String,String> missing=ArrayListMultimap.create();
  blockRegistry.dump();
  itemRegistry.dump();
  blockRegistry.beginIdSwap();
  itemRegistry.beginIdSwap();
  for (  Entry<String,Integer> entry : dataList.entrySet()) {
    String itemName=entry.getKey();
    char discriminator=itemName.charAt(0);
    itemName=itemName.substring(1);
    Integer newId=entry.getValue();
    int currId;
    boolean isBlock=discriminator == '\u0001';
    if (isBlock) {
      currId=blockRegistry.getId(itemName);
    }
 else {
      currId=itemRegistry.getId(itemName);
    }
    if (currId == -1) {
      FMLLog.info("Found a missing id from the world %s",itemName);
      missing.put(itemName.substring(0,itemName.indexOf(':')),itemName);
    }
 else     if (currId != newId) {
      FMLLog.info("Found %s id mismatch %s : %d %d",isBlock ? "block" : "item",itemName,currId,newId);
      remaps.put(itemName,new Integer[]{currId,newId});
    }
    if (isBlock) {
      blockRegistry.reassignMapping(itemName,newId);
    }
 else {
      itemRegistry.reassignMapping(itemName,newId);
    }
  }
  boolean successfullyLoaded=Loader.instance().fireMissingMappingEvent(missing);
  if (!successfullyLoaded) {
    blockRegistry.revertSwap();
    itemRegistry.revertSwap();
    return false;
  }
  if (injectFrozenData) {
    FMLLog.info("Injecting new block and item data into this server instance");
    Map<String,Integer> missingBlocks=Maps.newHashMap(blockRegistry.getMissingMappings());
    Map<String,Integer> missingItems=Maps.newHashMap(itemRegistry.getMissingMappings());
    for (    Entry<String,Integer> item : missingItems.entrySet()) {
      String itemName=item.getKey();
      if (missingBlocks.containsKey(itemName)) {
        int blockId=blockRegistry.swap(item.getValue(),itemName,blockRegistry.get(itemName));
        itemRegistry.swap(blockId,itemName,itemRegistry.get(itemName));
        FMLLog.info("Injecting new block/item %s : %d",itemName,blockId);
        missingBlocks.remove(itemName);
        if (Integer.valueOf(blockId) != item.getValue()) {
          remaps.put(itemName,new Integer[]{item.getValue(),blockId});
        }
      }
 else {
        FMLLog.info("Injecting new item %s",itemName);
        int itemId=itemRegistry.swap(item.getValue(),itemName,itemRegistry.get(itemName));
        if (Integer.valueOf(itemId) != item.getValue()) {
          remaps.put(itemName,new Integer[]{item.getValue(),itemId});
        }
      }
    }
    for (    Entry<String,Integer> block : missingBlocks.entrySet()) {
      FMLLog.info("Injecting new block %s",block.getKey());
      int blockId=blockRegistry.swap(block.getValue(),block.getKey(),blockRegistry.get(block.getKey()));
      if (Integer.valueOf(blockId) != block.getValue()) {
        remaps.put(block.getKey(),new Integer[]{block.getValue(),blockId});
      }
    }
  }
  blockRegistry.completeIdSwap();
  itemRegistry.completeIdSwap();
  blockRegistry.dump();
  itemRegistry.dump();
  Loader.instance().fireRemapEvent(remaps);
  return true;
}
