{
  ModContainer mc=Loader.instance().activeModContainer();
  if (modId != null) {
    customOwners.put(new UniqueIdentifier(modId,name),mc);
  }
  BitSet blockAvailability=blockRegistry.slots();
  BitSet itemAvailability=itemRegistry.slots();
  blockAvailability.or(itemAvailability);
  int blockId=blockAvailability.nextClearBit(0);
  if (blockId >= blockRegistry.maxId) {
    throw new RuntimeException(String.format("No more space for block allocations: used %d block ids",blockId - 1));
  }
  int actualBlockId=blockRegistry.add(blockId,name,block);
  int itemId=itemRegistry.add(blockId,name,item);
  if (blockId != actualBlockId || itemId != blockId) {
    throw new RuntimeException(String.format("There was a failure to allocate a matching block and item pair for %s: requested %d, got %d and %d",name,blockId,actualBlockId,itemId));
  }
}
