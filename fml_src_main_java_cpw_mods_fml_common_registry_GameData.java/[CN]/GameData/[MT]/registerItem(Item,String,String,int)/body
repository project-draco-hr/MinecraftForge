{
  if (modId != null) {
    ModContainer mc=Loader.instance().activeModContainer();
    customOwners.put(new UniqueIdentifier(modId,name),mc);
  }
  if (item instanceof ItemBlock) {
    idHint=iBlockRegistry.getId(((ItemBlock)item).field_150939_a);
    if (idHint == -1) {
      throw new RuntimeException("Cannot register an itemblock before its block");
    }
    if (iItemRegistry.getObjectById(idHint) != null) {
      throw new IllegalStateException(String.format("The Item Registry slot %d is already used by %s",idHint,iItemRegistry.getObjectById(idHint)));
    }
    freeSlot(idHint);
  }
  int itemId=iItemRegistry.add(idHint,name,item,availabilityMap);
  if (item instanceof ItemBlock) {
    if (itemId != idHint) {
      throw new IllegalStateException("ItemBlock insertion failed.");
    }
  }
  useSlot(itemId);
  return itemId;
}
