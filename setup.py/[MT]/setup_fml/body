def setup_fml(mcp_dir, fml_dir, build_num=0):
    print 'Setting up Forge ModLoader'
    os.environ['WORKSPACE'] = os.path.join(mcp_dir, '..')
    os.environ['BUILD_NUMBER'] = str(build_num)
    BUILD = ['ant', 'jenkinsbuild']
    if sys.platform.startswith('win'):
        BUILD = (['cmd', '/C'] + BUILD)
    if (not run_command(BUILD, cwd=fml_dir)):
        print 'Could not setup FML'
        sys.exit(1)
    sys.path.append(fml_dir)
    sys.path.append(os.path.join(fml_dir, 'install'))
    from fml import finish_setup_fml
    finish_setup_fml(fml_dir, mcp_dir)
    print 'Copy resources:'
    for file in os.listdir(os.path.join(fml_dir, 'client')):
        if (os.path.isfile(file) and (not (os.path.splitext(file)[1] == '.java'))):
            base = os.path.basename(file)
            print ('    fml/client/' + base)
            shutil.copy(file, os.path.join(mcp_dir, 'src', base))
    for file in os.listdir(os.path.join(fml_dir, 'common')):
        if (os.path.isfile(file) and (not (os.path.splitext(file)[1] == '.java'))):
            base = os.path.basename(file)
            print ('    fml/common/' + base)
            shutil.copy(file, os.path.join(mcp_dir, 'src', base))
    name = 'fmlversion.properties'
    print ('    ' + name)
    shutil.copy(os.path.join(fml_dir, name), os.path.join(mcp_dir, 'src', name))
